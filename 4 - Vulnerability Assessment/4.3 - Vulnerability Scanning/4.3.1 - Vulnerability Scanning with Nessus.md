- Nessus is a proprietary vulnerability scanner developed by Tenable.
- We can utilize Nessus to perform a vulnerability scan on a target system, after which, we can import the Nessus results in to MSF for analysis and exploitation.
- Nessus automates the process of identifying vulnerabilities and also provides us with information pertinent to a vulnerability like the CVE code.
- We can use the free version of Nessus (Nessus Essentials), which allows us to scan up to 16 IPs.

Lab Environment
- For the purposes of demonstrating the vulnerability scanning process, we will be utilizing an intentionally vulnerable virtual machine called Metasploitable3, which is based on Windows Server 2008.
- Metasploitable3 was developed by Rapid7 to demonstrate how MSF can be used to perform exploitation of a Windows System.
- Instructions on how this VM can be setup can be found on https://github.com/rapid7/metasploitable3.

Practical Demonstration
- Downloading Nessus Essentials from https://www.tenable.com/products/nessus/nessus-essentials.
- Installing Nessus Essentials using the deb package, we get after the whole activation process is completed as instructed by the Nessus website.
- Installation
	- `cd Downloads`
	- `ls`
	- `chmod +x ./Nessus*.deb`
	- `sudo dpkg -i ./Nessus*.deb`
- Usage
	- `sudo systemctl start nessusd.service`
	- `systemctl status nessusd.service`
	- Use the browser to navigate to the specified port on localhost, and use the activation code from earlier to activate Nessus Essentials.
	- Create an administrator user account.
	- Since we already know what the target I.P. address is, we can now close the welcome prompt asking us to perform a discovery scan, and move on to a new "Basic Network" scan.
	- Provide a name, description and the target IP address value.
	- Credentials can also be provided to initiate an authenticated network scan instead of an unauthenticated one.
	- Specific plugins can also be selected to be used for the scan.
	- The port range, scan type based on discovery methods, etcetera, can be specified under the Discovery sub-menu in the scan's settings menu.
	- The scan type, based on vulnerability types, can be changed in the Assessment sub-menu in the scan's settings menu.
	- Scan Output settings can be modified in the Report sub-menu in the scan's settings menu.
	- The "speed" of the scan be modified in the Advanced sub-menu in the scan's settings menu.
	- Go to the My Scans page, and start the vulnerability scan we just created.
	- The scan upon completion, can be checked the report for, the report includes details like Vulnerabilities, Remediations, Target Hosts etc.
	- Custom filter options can be set to filter through the vulnerabilities being displayed in the report.
	- A vulnerability represented in the report, when opened to provide more information, would generally provide a description of the vulnerability, a remediation, vulnerability disclosure and exploitability information (which may include the Metasploit exploit module name), the CVE value, and the CVSS score of the vulnerability.
	- Important filters for vulnerability scanning are "severity", "Metasploit Exploit Framework" and "Metasploit Name".

Exporting Nessus scan results to the Metasploit Framework
	- Nessus reports can be exported into various formats like Nessus and Nessus DB.
	- The first step to creating a MSF-importable Nessus report is to export the report to the Nessus format, which will provide us with a xml file.
	- Next, we will start PostgreSQL and Metasploit Framework.
		- `service postgresql start && msfconsole`
	- `workspace -a ms3_nessus`
	- `db_import`
	- `db_import /home/kali/downloads/MS3_*.nessus`
	- `hosts`
	- `services`
	- `vulns`
	- `services`
	- `vulns -p 445`
	- The CVE code provided in the output can be used to perform a custom search on Metasploit.
	- `search cve:2017 name:smb`
	- `search cve:2012 name:rdp`
	- `search cve:MS12-020`
	- `search cve:2015 name:ManageEngine`
	- We can also find the CVE codes, or Metasploit exploit module names to look for on Metasploit using the Nessus Interface.
	- `search cve:2019 name:rdp`
	- `search PHP CGI Argument Injection`