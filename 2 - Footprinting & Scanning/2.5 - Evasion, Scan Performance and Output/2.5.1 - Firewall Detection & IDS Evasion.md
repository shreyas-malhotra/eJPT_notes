- The objective of this section is to detect the presence of a host based firewall, or a filtering mechanism on the target host.
- The packets sent by Nmap scans can be modified to avoid triggering Intrusion Detection Systems.
- Nmap has inbuilt features that can be used for evading Intrusion Detection Systems, or masking the identity of the system performing the scans on the target network or host.

Firewall Detection with Nmap
	TCP ACK Scan (`sudo nmap -sA 10.10.0.1`)
		- The TCP ACK Scan can help us figure out if an open port is filtered or not.
		- We can initially perform a TCP SYN Scan using the `-sS` flag to determine whether the specified ports are open, and then perform a TCP ACK Scan using the `-sA` flag to determine if the port is filtered or not.

Firewall/IDS Evasion with Nmap
	Packet Fragmentation (`sudo nmap -sS -f -p- 10.10.0.1)
		- Fragmentation in networking refers to the process of breaking down a packet, usually because they are large, into smaller individual packets, that are reassembled when they arrive at the destination host.
		- Packet fragmentation helps with the process of Firewall/IDS evasion, since it makes it difficult for the security device to determine the structure of the sent packet, which at that point is broken down into multiple unique packets, and thus make it difficult to determine for the IDS whether to flag the packets as malicious activity or not.
		- The network traffic will now be transferred as Fragmented IP packets, instead of TCP packets, since packet fragmentation occurs at the Network Layer, and will show up likewise on a network traffic analyzer like Wireshark.
		- Packet fragmentation can be performed with the help of the `-f` flag.
		- Custom MTU values can be specified with the `--mtu flag`.		
		- MTU stands for the Minimum Transmission Unit size for each packet. It essentially refers to the size of data (in bytes) that will get transferred in an individual fragmented packet.
	 IP Spoofing with Nmap (`sudo nmap -g 53 -D 192.168.0.1`)
		- Requirements: You should be connected to the network, and the decoy IP should correspond to the network that you are operating in.
		- The decoy IP address can be specified using the `-D` option.
		- We can also specify multiple decoy IP address, as represented in the example below.
		- Custom TTL and data length values can be set with the `--ttl` and `--data-length` options respectively.
		- The transfer of some data between the attack-box and the target host will be apparent in the network traffic capture, but the scans will be performed via the decoy IPs.
		- Custom source port for the scans can be specified using the `-g` or the `--source-port` option.
		- Example: `nmap -Pn -sS -sV -p445,3389 -f --data-length 200 -D 10.10.23.1,10.10.23.2 -g 53 10.10.0.1`
	MAC Spoofing with Nmap (`sudo nmap 192.168.0.1 --spoof-mac Apple`)
		- MAC spoofing using Nmap, only spoofs the MAC address for the network traffic data sent by Nmap, not the network traffic generated by the system as a whole.
		- MAC spoofing using Nmap can be done using either:
			- Vendor specific MAC address allocation using vendor name: `sudo nmap 192.168.0.1 --spoof-mac Apple`
			- User specified MAC address allocation: `sudo nmap 192.168.0.1 --spoof-mac 00:11:22:33:44:55`
			- Random MAC address allocation by setting the MAC address value as 0: `sudo nmap 192.168.0.1 --spoof-mac 0`